import os
import csv
import pandas as pd
import matplotlib.pyplot as plt

# List of .out files you want to convert
out_files = ['_Test[0SOC]_Proc[00DCIR_Charge]_Cell[4680_0SoC_Bike_AF_2].out' ,
'_Test[0SOC]_Proc[00DCIR_Discharge]_Cell[4680_0SoC_Bike_AF_2].out',
'_Test[0SOC]_Proc[10DCIR_Charge]_Cell[4680_0SoC_Bike_AF_2].out',
'_Test[0SOC]_Proc[10DCIR_Discharge]_Cell[4680_0SoC_Bike_AF_2].out',
'_Test[0SOC]_Proc[25DCIR_Charge]_Cell[4680_0SoC_Bike_AF_2].out',
'_Test[0SOC]_Proc[25DCIR_Discharge]_Cell[4680_0SoC_Bike_AF_2].out',
'_Test[0SOC]_Proc[45DCIR_Charge]_Cell[4680_0SoC_Bike_AF_2].out',
'_Test[0SOC]_Proc[45DCIR_Discharge]_Cell[4680_0SoC_Bike_AF_2].out',
'_Test[0SOC]_Proc[55DCIR_Charge]_Cell[4680_0SoC_Bike_AF_2].out',
'_Test[0SOC]_Proc[55DCIR_Discharge]_Cell[4680_0SoC_Bike_AF_2].out',
'_Test[0SOC]_Proc[Neg20DCIR_Charge]_Cell[4680_0SoC_Bike_AF_2].out',
'_Test[0SOC]_Proc[Neg20DCIR_Discharge]_Cell[4680_0SoC_Bike_AF_2].out',
'_Test[100SOC]_Proc[00DCIR_Charge]_Cell[4680_100SoC_Bike_AF_2].out',
'_Test[100SOC]_Proc[00DCIR_Discharge]_Cell[4680_100SoC_Bike_AF_2].out',
'_Test[100SOC]_Proc[10DCIR_Charge]_Cell[4680_100SoC_Bike_AF_2].out',
'_Test[100SOC]_Proc[10DCIR_Discharge]_Cell[4680_100SoC_Bike_AF_2].out',
'_Test[100SOC]_Proc[25DCIR_Charge]_Cell[4680_100SoC_Bike_AF_2].out',
'_Test[100SOC]_Proc[25DCIR_Discharge]_Cell[4680_100SoC_Bike_AF_2].out',
'_Test[100SOC]_Proc[45DCIR_Charge]_Cell[4680_100SoC_Bike_AF_2].out',
'_Test[100SOC]_Proc[45DCIR_Discharge]_Cell[4680_100SoC_Bike_AF_2].out',
'_Test[100SOC]_Proc[55DCIR_Charge]_Cell[4680_100SoC_Bike_AF_2].out',
'_Test[100SOC]_Proc[55DCIR_Discharge]_Cell[4680_100SoC_Bike_AF_2].out',
'_Test[100SOC]_Proc[Neg20DCIR_Charge]_Cell[4680_100SoC_Bike_AF_2].out',
'_Test[100SOC]_Proc[Neg20DCIR_Discharge]_Cell[4680_100SoC_Bike_AF_2].out',
'_Test[10SOC]_Proc[00DCIR_Charge]_Cell[4680_10SoC_Bike_AF_2].out',
'_Test[10SOC]_Proc[00DCIR_Discharge]_Cell[4680_10SoC_Bike_AF_2].out',
'_Test[10SOC]_Proc[10DCIR_Charge]_Cell[4680_10SoC_Bike_AF_2].out',
'_Test[10SOC]_Proc[10DCIR_Discharge]_Cell[4680_10SoC_Bike_AF_2].out',
'_Test[10SOC]_Proc[25DCIR_Charge]_Cell[4680_10SoC_Bike_AF_2].out',
'_Test[10SOC]_Proc[25DCIR_Discharge]_Cell[4680_10SoC_Bike_AF_2].out',
'_Test[10SOC]_Proc[45DCIR_Charge]_Cell[4680_10SoC_Bike_AF_2].out',
'_Test[10SOC]_Proc[45DCIR_Discharge]_Cell[4680_10SoC_Bike_AF_2].out',
'_Test[10SOC]_Proc[55DCIR_Charge]_Cell[4680_10SoC_Bike_AF_2].out',
'_Test[10SOC]_Proc[55DCIR_Discharge]_Cell[4680_10SoC_Bike_AF_2].out',
'_Test[10SOC]_Proc[Neg20DCIR_Charge]_Cell[4680_10SoC_Bike_AF_2].out',
'_Test[10SOC]_Proc[Neg20DCIR_Discharge]_Cell[4680_10SoC_Bike_AF_2].out',
'_Test[20SOC]_Proc[00DCIR_Charge]_Cell[4680_20SoC_Bike_AF_2].out',
'_Test[20SOC]_Proc[00DCIR_Discharge]_Cell[4680_20SoC_Bike_AF_2].out',
'_Test[20SOC]_Proc[10DCIR_Charge]_Cell[4680_20SoC_Bike_AF_2].out',
'_Test[20SOC]_Proc[10DCIR_Discharge]_Cell[4680_20SoC_Bike_AF_2].out',
'_Test[20SOC]_Proc[25DCIR_Charge]_Cell[4680_20SoC_Bike_AF_2].out',
'_Test[20SOC]_Proc[25DCIR_Discharge]_Cell[4680_20SoC_Bike_AF_2].out',
'_Test[20SOC]_Proc[45DCIR_Charge]_Cell[4680_20SoC_Bike_AF_2].out',
'_Test[20SOC]_Proc[45DCIR_Discharge]_Cell[4680_20SoC_Bike_AF_2].out',
'_Test[20SOC]_Proc[55DCIR_Charge]_Cell[4680_20SoC_Bike_AF_2].out',
'_Test[20SOC]_Proc[55DCIR_Discharge]_Cell[4680_20SoC_Bike_AF_2].out',
'_Test[20SOC]_Proc[Neg20DCIR_Charge]_Cell[4680_20SoC_Bike_AF_2].out',
'_Test[20SOC]_Proc[Neg20DCIR_Discharge]_Cell[4680_20SoC_Bike_AF_2].out',
'_Test[30SOC]_Proc[00DCIR_Charge]_Cell[4680_30SoC_Bike_AF_2].out',
'_Test[30SOC]_Proc[00DCIR_Discharge]_Cell[4680_30SoC_Bike_AF_2].out',
'_Test[30SOC]_Proc[10DCIR_Charge]_Cell[4680_30SoC_Bike_AF_2].out',
'_Test[30SOC]_Proc[10DCIR_Discharge]_Cell[4680_30SoC_Bike_AF_2].out',
'_Test[30SOC]_Proc[25DCIR_Charge]_Cell[4680_30SoC_Bike_AF_2].out',
'_Test[30SOC]_Proc[25DCIR_Discharge]_Cell[4680_30SoC_Bike_AF_2].out',
'_Test[30SOC]_Proc[45DCIR_Charge]_Cell[4680_30SoC_Bike_AF_2].out',
'_Test[30SOC]_Proc[45DCIR_Discharge]_Cell[4680_30SoC_Bike_AF_2].out',
'_Test[30SOC]_Proc[55DCIR_Charge]_Cell[4680_30SoC_Bike_AF_2].out',
'_Test[30SOC]_Proc[55DCIR_Discharge]_Cell[4680_30SoC_Bike_AF_2].out',
'_Test[30SOC]_Proc[Neg20DCIR_Charge]_Cell[4680_30SoC_Bike_AF_2].out',
'_Test[30SOC]_Proc[Neg20DCIR_Discharge]_Cell[4680_30SoC_Bike_AF_2].out',
'_Test[40SOC]_Proc[00DCIR_Charge]_Cell[4680_40SoC_Bike_AF_2].out',
'_Test[40SOC]_Proc[00DCIR_Discharge]_Cell[4680_40SoC_Bike_AF_2].out',
'_Test[40SOC]_Proc[10DCIR_Charge]_Cell[4680_40SoC_Bike_AF_2].out',
'_Test[40SOC]_Proc[10DCIR_Discharge]_Cell[4680_40SoC_Bike_AF_2].out',
'_Test[40SOC]_Proc[25DCIR_Charge]_Cell[4680_40SoC_Bike_AF_2].out',
'_Test[40SOC]_Proc[25DCIR_Discharge]_Cell[4680_40SoC_Bike_AF_2].out',
'_Test[40SOC]_Proc[45DCIR_Charge]_Cell[4680_40SoC_Bike_AF_2].out',
'_Test[40SOC]_Proc[45DCIR_Discharge]_Cell[4680_40SoC_Bike_AF_2].out',
'_Test[40SOC]_Proc[55DCIR_Charge]_Cell[4680_40SoC_Bike_AF_2].out',
'_Test[40SOC]_Proc[55DCIR_Discharge]_Cell[4680_40SoC_Bike_AF_2].out',
'_Test[40SOC]_Proc[Neg20DCIR_Charge]_Cell[4680_40SoC_Bike_AF_2].out',
'_Test[40SOC]_Proc[Neg20DCIR_Discharge]_Cell[4680_40SoC_Bike_AF_2].out',
'_Test[50SOC]_Proc[00DCIR_Charge]_Cell[4680_50SoC_Bike_AF_2].out',
'_Test[50SOC]_Proc[00DCIR_Discharge]_Cell[4680_50SoC_Bike_AF_2].out',
'_Test[50SOC]_Proc[10DCIR_Charge]_Cell[4680_50SoC_Bike_AF_2].out',
'_Test[50SOC]_Proc[10DCIR_Discharge]_Cell[4680_50SoC_Bike_AF_2].out',
'_Test[50SOC]_Proc[25DCIR_Charge]_Cell[4680_50SoC_Bike_AF_2].out',
'_Test[50SOC]_Proc[25DCIR_Discharge]_Cell[4680_50SoC_Bike_AF_2].out',
'_Test[50SOC]_Proc[45DCIR_Charge]_Cell[4680_50SoC_Bike_AF_2].out',
'_Test[50SOC]_Proc[45DCIR_Discharge]_Cell[4680_50SoC_Bike_AF_2].out',
'_Test[50SOC]_Proc[55DCIR_Charge]_Cell[4680_50SoC_Bike_AF_2].out',
'_Test[50SOC]_Proc[55DCIR_Discharge]_Cell[4680_50SoC_Bike_AF_2].out',
'_Test[50SOC]_Proc[Neg20DCIR_Charge]_Cell[4680_50SoC_Bike_AF_2].out',
'_Test[50SOC]_Proc[Neg20DCIR_Discharge]_Cell[4680_50SoC_Bike_AF_2].out',
'_Test[60SOC]_Proc[00DCIR_Charge]_Cell[4680_60SoC_Bike_AF_2].out',
'_Test[60SOC]_Proc[00DCIR_Discharge]_Cell[4680_60SoC_Bike_AF_2].out',
'_Test[60SOC]_Proc[10DCIR_Charge]_Cell[4680_60SoC_Bike_AF_2].out',
'_Test[60SOC]_Proc[10DCIR_Discharge]_Cell[4680_60SoC_Bike_AF_2].out',
'_Test[60SOC]_Proc[25DCIR_Charge]_Cell[4680_60SoC_Bike_AF_2].out',
'_Test[60SOC]_Proc[25DCIR_Discharge]_Cell[4680_60SoC_Bike_AF_2].out',
'_Test[60SOC]_Proc[45DCIR_Charge]_Cell[4680_60SoC_Bike_AF_2].out',
'_Test[60SOC]_Proc[45DCIR_Discharge]_Cell[4680_60SoC_Bike_AF_2].out',
'_Test[60SOC]_Proc[55DCIR_Charge]_Cell[4680_60SoC_Bike_AF_2].out',
'_Test[60SOC]_Proc[55DCIR_Discharge]_Cell[4680_60SoC_Bike_AF_2].out',
'_Test[60SOC]_Proc[Neg20DCIR_Charge]_Cell[4680_60SoC_Bike_AF_2].out',
'_Test[60SOC]_Proc[Neg20DCIR_Discharge]_Cell[4680_60SoC_Bike_AF_2].out',
'_Test[70SOC]_Proc[00DCIR_Charge]_Cell[4680_70SoC_Bike_AF_2].out',
'_Test[70SOC]_Proc[00DCIR_Discharge]_Cell[4680_70SoC_Bike_AF_2].out',
'_Test[70SOC]_Proc[10DCIR_Charge]_Cell[4680_70SoC_Bike_AF_2].out',
'_Test[70SOC]_Proc[10DCIR_Discharge]_Cell[4680_70SoC_Bike_AF_2].out',
'_Test[70SOC]_Proc[25DCIR_Charge]_Cell[4680_70SoC_Bike_AF_2].out',
'_Test[70SOC]_Proc[25DCIR_Discharge]_Cell[4680_70SoC_Bike_AF_2].out',
'_Test[70SOC]_Proc[45DCIR_Charge]_Cell[4680_70SoC_Bike_AF_2].out',
'_Test[70SOC]_Proc[45DCIR_Discharge]_Cell[4680_70SoC_Bike_AF_2].out',
'_Test[70SOC]_Proc[55DCIR_Charge]_Cell[4680_70SoC_Bike_AF_2].out',
'_Test[70SOC]_Proc[55DCIR_Discharge]_Cell[4680_70SoC_Bike_AF_2].out',
'_Test[70SOC]_Proc[Neg20DCIR_Charge]_Cell[4680_70SoC_Bike_AF_2].out',
'_Test[70SOC]_Proc[Neg20DCIR_Discharge]_Cell[4680_70SoC_Bike_AF_2].out',
'_Test[80SOC]_Proc[00DCIR_Charge]_Cell[4680_80SoC_Bike_AF_2].out',
'_Test[80SOC]_Proc[00DCIR_Discharge]_Cell[4680_80SoC_Bike_AF_2].out',
'_Test[80SOC]_Proc[10DCIR_Charge]_Cell[4680_80SoC_Bike_AF_2].out',
'_Test[80SOC]_Proc[10DCIR_Discharge]_Cell[4680_80SoC_Bike_AF_2].out',
'_Test[80SOC]_Proc[25DCIR_Charge]_Cell[4680_80SoC_Bike_AF_2].out',
'_Test[80SOC]_Proc[25DCIR_Discharge]_Cell[4680_80SoC_Bike_AF_2].out',
'_Test[80SOC]_Proc[45DCIR_Charge]_Cell[4680_80SoC_Bike_AF_2].out',
'_Test[80SOC]_Proc[45DCIR_Discharge]_Cell[4680_80SoC_Bike_AF_2].out',
'_Test[80SOC]_Proc[55DCIR_Charge]_Cell[4680_80SoC_Bike_AF_2].out',
'_Test[80SOC]_Proc[55DCIR_Discharge]_Cell[4680_80SoC_Bike_AF_2].out',
'_Test[80SOC]_Proc[Neg20DCIR_Charge]_Cell[4680_80SoC_Bike_AF_2].out',
'_Test[80SOC]_Proc[Neg20DCIR_Discharge]_Cell[4680_80SoC_Bike_AF_2].out',
'_Test[90SOC]_Proc[00DCIR_Charge]_Cell[4680_90SoC_Bike_AF_2].out',
'_Test[90SOC]_Proc[00DCIR_Discharge]_Cell[4680_90SoC_Bike_AF_2].out',
'_Test[90SOC]_Proc[10DCIR_Charge]_Cell[4680_90SoC_Bike_AF_2].out',
'_Test[90SOC]_Proc[10DCIR_Discharge]_Cell[4680_90SoC_Bike_AF_2].out',
'_Test[90SOC]_Proc[25DCIR_Charge]_Cell[4680_90SoC_Bike_AF_2].out',
'_Test[90SOC]_Proc[25DCIR_Discharge]_Cell[4680_90SoC_Bike_AF_2].out',
'_Test[90SOC]_Proc[45DCIR_Charge]_Cell[4680_90SoC_Bike_AF_2].out',
'_Test[90SOC]_Proc[45DCIR_Discharge]_Cell[4680_90SoC_Bike_AF_2].out',
'_Test[90SOC]_Proc[55DCIR_Charge]_Cell[4680_90SoC_Bike_AF_2].out',
'_Test[90SOC]_Proc[55DCIR_Discharge]_Cell[4680_90SoC_Bike_AF_2].out',
'_Test[90SOC]_Proc[Neg20DCIR_Charge]_Cell[4680_90SoC_Bike_AF_2].out' ,
'_Test[90SOC]_Proc[Neg20DCIR_Discharge]_Cell[4680_90SoC_Bike_AF_2].out' ]
tsv_files = [os.path.splitext(file)[0] + ".tsv" for file in out_files]

# Convert .out to .tsv
for in_file, out_file in zip(out_files, tsv_files):
    with open(in_file, "r") as infile, open(out_file, "w") as outfile:
        outfile.writelines(infile.readlines()[20:])

# Convert .tsv to .csv
csv_files = [file.replace(".tsv", ".csv") for file in tsv_files]

for tsv_file, csv_file in zip(tsv_files, csv_files):
    with open(tsv_file, 'r', newline='', encoding='utf-8', errors='ignore') as tsvfile, open(csv_file, 'w', newline='', encoding='utf-8', errors='ignore') as csvfile:
        tsvreader = csv.reader(tsvfile, delimiter='\t')
        csvwriter = csv.writer(csvfile, delimiter=',')
        csvwriter.writerows(tsvreader)

    print(f"Conversion from '{tsv_file}' to '{csv_file}' complete.")